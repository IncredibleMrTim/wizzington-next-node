# Apache Proxy Configuration for Plesk
# Add this to: Websites & Domains → Your Domain → Apache & Nginx Settings
# Section: Additional directives for HTTP/HTTPS

# Enable required modules (should be enabled in Plesk)
# - mod_proxy
# - mod_proxy_http
# - mod_proxy_wstunnel (for WebSocket support)

# Preserve the original host header
ProxyPreserveHost On

# Proxy /api requests to the API server (port 3001)
ProxyPass /api http://localhost:3001
ProxyPassReverse /api http://localhost:3001

# Proxy all other requests to Next.js (port 3000)
ProxyPass / http://localhost:3000/
ProxyPassReverse / http://localhost:3000/

# WebSocket support
RewriteEngine On
RewriteCond %{HTTP:Upgrade} =websocket [NC]
RewriteRule /(.*)           ws://localhost:3000/$1 [P,L]

# Access control
<Location />
    Order allow,deny
    Allow from all
</Location>

# Timeouts
ProxyTimeout 300
